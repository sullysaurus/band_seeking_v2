<!-- app/views/profiles/_bio_card.html.erb -->

<!-- Bio Card -->
<div class="bg-white shadow rounded-lg p-6">
  <div class="mb-6" data-controller="about-edit">
    <div class="flex items-center mb-3">
      <svg class="w-5 h-5 text-gray-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
      </svg>
      <h3 class="font-bold text-lg">About Me</h3>
    </div>

    <div class="relative group">
      <div class="text-gray-600 group-hover:bg-gray-50 rounded-lg p-3 cursor-pointer"
           data-about-edit-target="display"
           data-action="click->about-edit#showInput">
        <%= profile.bio.presence || "Click to add your bio..." %>
      </div>

      <div class="hidden" data-about-edit-target="form">
        <%= form_with(model: profile, data: { action: "submit->about-edit#save" }) do |f| %>
          <%= f.text_area :bio,
              class: "w-full p-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",
              rows: 4,
              placeholder: "Tell us about yourself...",
              data: {
                about_edit_target: "input",
                action: "keydown->about-edit#handleKeydown blur->about-edit#handleBlur"
              } %>

          <div class="flex gap-2 mt-2">
            <button type="submit"
                    class="px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm">
              Save
            </button>
            <button type="button"
                    class="px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 text-sm"
                    data-action="click->about-edit#cancel">
              Cancel
            </button>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
